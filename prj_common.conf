CONFIG_KERNEL_BIN_NAME="ruuvi_air_fw"

CONFIG_POSIX_API=y
CONFIG_POSIX_TIMERS=y
CONFIG_HEAP_MEM_POOL_SIZE=65536

CONFIG_EVENTS=y
CONFIG_GPIO=y
CONFIG_PWM=y
CONFIG_ADC=y
CONFIG_I2C=y
CONFIG_SENSOR=y
CONFIG_DPS310=y
CONFIG_LED=y
CONFIG_LP5810=y
CONFIG_LP5810_EXPONENTIAL_PWM=y
CONFIG_WATCHDOG=y
CONFIG_HWINFO=y

CONFIG_LED_INIT_PRIORITY=50
CONFIG_RTC_INIT_PRIORITY=51
CONFIG_SENSOR_INIT_PRIORITY=90

CONFIG_FLASH=y
CONFIG_FLASH_MAP=y
CONFIG_NORDIC_QSPI_NOR=y
CONFIG_FCB=y
CONFIG_FCB_ALLOW_FIXED_ENDMARKER=y

CONFIG_NVS=y
CONFIG_NVS_LOOKUP_CACHE=y
CONFIG_NVS_LOOKUP_CACHE_FOR_SETTINGS=y
CONFIG_NVS_DATA_CRC=y
CONFIG_SETTINGS=y
CONFIG_SETTINGS_NVS=y

# Enable the LittleFS file system.
CONFIG_FILE_SYSTEM=y
CONFIG_FILE_SYSTEM_LITTLEFS=y
CONFIG_FILE_SYSTEM_MKFS=y

CONFIG_AUDIO=y
CONFIG_AUDIO_DMIC=y
CONFIG_CMSIS_DSP=y
CONFIG_CMSIS_DSP_STATISTICS=y
CONFIG_CMSIS_DSP_FILTERING=y

CONFIG_RUUVI_AIR_BUTTON_DELAY_BEFORE_REBOOT=5000

# CONFIG_RUUVI_AIR_MIC_NONE=y
CONFIG_RUUVI_AIR_MIC_SPG08P4HM4H=y
CONFIG_RUUVI_AIR_MIC_PDM_THREAD_PRIORITY=-11
CONFIG_RUUVI_AIR_MIC_PDM_THREAD_STACK_SIZE=4096
# CONFIG_RUUVI_AIR_MIC_PDM_SAMPLE_RATE=16000
CONFIG_RUUVI_AIR_MIC_PDM_SAMPLE_RATE=20828

CONFIG_RUUVI_AIR_NUS_THREAD_PRIORITY=12
CONFIG_RUUVI_AIR_NUS_THREAD_STACK_SIZE=4096

CONFIG_OPT4060=y
CONFIG_OPT4060_INT_NONE=y
CONFIG_OPT4060_OP_MODE_ONESHOT=n
CONFIG_OPT4060_OP_MODE_ONE_SHOT_FORCED_AUTO_RANGE=n

CONFIG_OPT4060_RANGE_AUTO=y

# CONFIG_OPT4060_CONV_TIME_600_US=y
# CONFIG_OPT4060_CONV_TIME_1_MS=y
# CONFIG_OPT4060_CONV_TIME_1_8_MS=y
# CONFIG_OPT4060_CONV_TIME_3_4_MS=y
CONFIG_OPT4060_CONV_TIME_6_5_MS=y

CONFIG_OPT4060_ONE_SHOT_MODE_QUICK_WAKEUP=y

CONFIG_RUUVI_AIR_OPT4060_NUM_MEASUREMENTS_PER_SECOND=5
CONFIG_RUUVI_AIR_OPT4060_LUMINOSITY_AVG_PERIOD=5
CONFIG_RUUVI_AIR_OPT4060_LUMINOSITY_MULTIPLIER=310

CONFIG_RUUVI_AIR_LED_BRIGHTNESS=25

CONFIG_RUUVI_AIR_PINHOLE_LED_PWM=y
CONFIG_RUUVI_AIR_PINHOLE_LED_PWM_PERIOD_NS=20000
CONFIG_RUUVI_AIR_PINHOLE_LED_PWM_PULSE_WIDTH_NS=1000

CONFIG_SPI=y
CONFIG_SPI_NRFX=y

# enable to use thread names
CONFIG_THREAD_NAME=y
CONFIG_THREAD_MONITOR=y
CONFIG_THREAD_STACK_INFO=y
CONFIG_THREAD_ANALYZER=y
CONFIG_THREAD_ANALYZER_ISR_STACK_USAGE=y
CONFIG_THREAD_ANALYZER_AUTO_INTERVAL=60
# CONFIG_THREAD_ANALYZER_USE_PRINTK=n
CONFIG_THREAD_ANALYZER_AUTO=y
CONFIG_THREAD_ANALYZER_USE_LOG=y
CONFIG_THREAD_ANALYZER_AUTO_STACK_SIZE=32768
CONFIG_SYS_HEAP_RUNTIME_STATS=y
CONFIG_SYS_HEAP_INFO=y

# Enable logging
CONFIG_LOG=y
CONFIG_LOG_THREAD_ID_PREFIX=y
CONFIG_LOG_TIMESTAMP_64BIT=y
CONFIG_LOG_OUTPUT_FORMAT_LINUX_TIMESTAMP=n
CONFIG_LOG_MAX_LEVEL=3
CONFIG_LOG_DEFAULT_LEVEL=3
# Enable logging for MCUboot
CONFIG_MCUBOOT_UTIL_LOG_LEVEL_INF=y

CONFIG_STDOUT_CONSOLE=n
CONFIG_LOG_MODE_DEFERRED=n
CONFIG_LOG_MODE_MINIMAL=n
CONFIG_LOG_MODE_IMMEDIATE=y
CONFIG_LOG_PROCESS_THREAD=n
CONFIG_LOG_BLOCK_IN_THREAD=n
CONFIG_LOG_PRINTK=y
CONFIG_PRINTK_SYNC=y
CONFIG_LOG_FUNC_NAME_PREFIX_ERR=y
CONFIG_LOG_FUNC_NAME_PREFIX_WRN=n
CONFIG_LOG_FUNC_NAME_PREFIX_INF=n
CONFIG_LOG_FUNC_NAME_PREFIX_DBG=y
CONFIG_LOG_BACKEND_SHOW_COLOR=y

# --- Enable UART ---
CONFIG_SERIAL=y           # Ensure Serial driver support is enabled (usually default)
CONFIG_UART_CONSOLE=y     # Enable UART as a potential console (usually default)
CONFIG_LOG_BACKEND_UART=y # Enable UART as a logging backend

# --- Enable RTT ---
CONFIG_USE_SEGGER_RTT=y
CONFIG_RTT_CONSOLE=y      # Enable RTT as a potential console
CONFIG_LOG_BACKEND_RTT=y  # Enable RTT as a logging backend

# Configure Segger RTT UpBuffer, with 184 additional bytes for other RTT data, in total it's 4096
CONFIG_SEGGER_RTT_BUFFER_SIZE_UP=3912
CONFIG_SEGGER_RTT_SECTION_CUSTOM=y
CONFIG_SEGGER_RTT_SECTION_CUSTOM_NAME="rtt_data"

CONFIG_EXCEPTION_DEBUG=y
CONFIG_EXTRA_EXCEPTION_INFO=y
CONFIG_FAULT_DUMP=2

CONFIG_ASSERT_VERBOSE=y
CONFIG_ASSERT_NO_FILE_INFO=n

CONFIG_REBOOT=y
CONFIG_POWEROFF=y

CONFIG_CBPRINTF_FP_SUPPORT=y
CONFIG_CBPRINTF_FULL_INTEGRAL=y
CONFIG_FPU=y
CONFIG_FP_HARDABI=y
CONFIG_FPU_SHARING=y

CONFIG_MP_MAX_NUM_CPUS=1

# Some command handlers require a large stack.
CONFIG_SYSTEM_WORKQUEUE_STACK_SIZE=4096
CONFIG_BT_RX_STACK_SIZE=4096
CONFIG_MAIN_STACK_SIZE=3072
CONFIG_MPSL_WORK_STACK_SIZE=3072

# Enable statistics and statistic names.
CONFIG_STATS=n
CONFIG_STATS_NAMES=n

# overlay_shell.conf:

## Enable the shell MCUmgr transport.
#CONFIG_BASE64=y
#CONFIG_CRC=y
#CONFIG_SHELL=y
#CONFIG_SHELL_BACKEND_SERIAL=y
#CONFIG_MCUMGR_TRANSPORT_SHELL=y
## mcumgr-cli application doesn't accepts log in the channel it uses
#CONFIG_SHELL_LOG_BACKEND=n

# overlay_bt.conf:

CONFIG_BT=y
CONFIG_BT_BROADCASTER=y
CONFIG_BT_PER_ADV=y
CONFIG_BT_MAX_CONN=3
CONFIG_BT_EXT_ADV=y
CONFIG_BT_EXT_ADV_MAX_ADV_SET=3
CONFIG_BT_CTLR_ADV_EXT=y
# CONFIG_BT_LL_SW_SPLIT=y
CONFIG_BT_CTLR_ADVANCED_FEATURES=y
CONFIG_BT_CTLR_ADV_DATA_LEN_MAX=48
CONFIG_BT_CTLR_PHY_2M=y
CONFIG_BT_DEVICE_NAME="RuuviAir"
CONFIG_BT_DEVICE_NAME_DYNAMIC=y
CONFIG_BT_PERIPHERAL=y
CONFIG_BT_ZEPHYR_NUS=y
CONFIG_BT_PHY_UPDATE=y
CONFIG_BT_USER_PHY_UPDATE=y
CONFIG_BT_USER_DATA_LEN_UPDATE=y
CONFIG_BT_GAP_AUTO_UPDATE_CONN_PARAMS=y
CONFIG_BT_HCI_ERR_TO_STR=y

# Allow for large Bluetooth data packets.
CONFIG_BT_L2CAP_TX_MTU=498
CONFIG_BT_BUF_ACL_RX_SIZE=502
CONFIG_BT_BUF_ACL_TX_SIZE=502
CONFIG_BT_CTLR_DATA_LENGTH_MAX=251

CONFIG_BT_L2CAP_TX_BUF_COUNT=10
CONFIG_BT_BUF_ACL_TX_COUNT=10
CONFIG_BT_BUF_ACL_RX_COUNT=10

CONFIG_BT_CTLR_TX_PWR_PLUS_8=y

# Enable LE Coded PHY
CONFIG_BT_PHY_UPDATE=y
CONFIG_BT_USER_PHY_UPDATE=y
# Set default PHY preferences
CONFIG_BT_CTLR_PHY_CODED=y
# CONFIG_BT_PHY_CODED=y
CONFIG_BT_CTLR_ADV_EXT=y
CONFIG_BT_CTLR_ASSERT_HANDLER=y


CONFIG_BT_DIS=y
CONFIG_BT_DIS_STR_MAX=24
CONFIG_BT_DIS_SETTINGS=y
CONFIG_BT_DIS_MODEL="Ruuvi Air"
CONFIG_BT_DIS_MANUF="Ruuvi Innovations Ltd"
CONFIG_BT_DIS_PNP=n
CONFIG_BT_DIS_SERIAL_NUMBER=y
CONFIG_BT_DIS_SERIAL_NUMBER_STR="XX:XX:XX:XX:XX:XX:XX:XX"
CONFIG_BT_DIS_FW_REV=y
CONFIG_BT_DIS_HW_REV=y
CONFIG_BT_DIS_HW_REV_STR="Check PCB"



# Disable Bluetooth ping support
CONFIG_BT_CTLR_LE_PING=n

# Disable shell commands that are not needed
CONFIG_CLOCK_CONTROL_NRF_SHELL=n
CONFIG_DEVICE_SHELL=n
CONFIG_DEVMEM_SHELL=n
CONFIG_FLASH_SHELL=n

CONFIG_NCS_SAMPLES_DEFAULTS=y
CONFIG_DK_LIBRARY=y
CONFIG_NFC_T2T_NRFXLIB=y
CONFIG_NFC_NDEF=y
CONFIG_NFC_NDEF_MSG=y
CONFIG_NFC_NDEF_RECORD=y
CONFIG_NFC_NDEF_TEXT_RECORD=y

# Enable MCUmgr and dependencies.
CONFIG_MCUMGR=y
CONFIG_ZCBOR=y
CONFIG_NET_BUF=y
CONFIG_CRC=y
CONFIG_STREAM_FLASH=y

# Enable the Shell mcumgr transport.
CONFIG_BASE64=y
CONFIG_CRC=y
CONFIG_SHELL=y
CONFIG_SHELL_ARGC_MAX=21
CONFIG_SHELL_BACKEND_SERIAL=n
CONFIG_MCUMGR_TRANSPORT_SHELL=y  # Enable MCUmgr shell command handler
# TODO: Disable shell over BLE in release builds
CONFIG_SHELL_BACKEND_DUMMY=y     # Use dummy backend to capture shell output
CONFIG_MCUMGR_GRP_SHELL=y


# Enable the Bluetooth mcumgr transport (unauthenticated).
CONFIG_MCUMGR_TRANSPORT_BT=y
CONFIG_MCUMGR_TRANSPORT_BT_CONN_PARAM_CONTROL=y

# Enable the mcumgr Packet Reassembly feature over Bluetooth and its configuration dependencies.
# MCUmgr buffer size is optimized to fit one SMP packet divided into five Bluetooth Write Commands,
# transmitted with the maximum possible MTU value: 498 bytes.
CONFIG_MCUMGR_TRANSPORT_BT_REASSEMBLY=y
CONFIG_MCUMGR_TRANSPORT_NETBUF_SIZE=2475
CONFIG_MCUMGR_TRANSPORT_WORKQUEUE_STACK_SIZE=6144

# Enable core commands.
CONFIG_MCUMGR_GRP_OS=y
CONFIG_MCUMGR_GRP_OS_MCUMGR_PARAMS=y
CONFIG_MCUMGR_GRP_OS_BOOTLOADER_INFO=y
CONFIG_MCUMGR_GRP_OS_BOOTLOADER_INFO_HOOK=y
CONFIG_MCUMGR_GRP_OS_INFO=y
CONFIG_MCUMGR_GRP_OS_INFO_CUSTOM_HOOKS=y
CONFIG_MCUMGR_GRP_OS_RESET_HOOK=y
# CONFIG_MCUMGR_GRP_OS_DATETIME=y
# CONFIG_MCUMGR_GRP_OS_DATETIME_MS=y
# CONFIG_MCUMGR_GRP_OS_DATETIME_HOOK=y
CONFIG_MCUMGR_GRP_OS_INFO_BUILD_DATE_TIME=y
CONFIG_STATS=y
CONFIG_MCUMGR_GRP_STAT=y
CONFIG_MCUMGR_GRP_FS=y
CONFIG_MCUMGR_GRP_FS_FILE_ACCESS_HOOK=y

# Support for taskstat command
CONFIG_MCUMGR_GRP_OS_TASKSTAT=y

# Enable the storage erase command.
CONFIG_MCUMGR_GRP_ZBASIC=n
CONFIG_MCUMGR_GRP_ZBASIC_STORAGE_ERASE=n

CONFIG_MCUMGR_MGMT_NOTIFICATION_HOOKS=y
CONFIG_MCUMGR_SMP_COMMAND_STATUS_HOOKS=y
CONFIG_MCUMGR_GRP_IMG_UPLOAD_CHECK_HOOK=y
CONFIG_MCUMGR_GRP_IMG_STATUS_HOOKS=y
CONFIG_BOOT_IMAGE_ACCESS_HOOKS=y
CONFIG_MCUMGR_GRP_IMG_IMAGE_SLOT_STATE_HOOK=y
CONFIG_MCUMGR_GRP_IMG_VERBOSE_ERR=y

CONFIG_RETAINED_MEM=y
CONFIG_RETENTION=y
CONFIG_RETENTION_BOOT_MODE=y
CONFIG_RETENTION_BOOTLOADER_INFO=y
CONFIG_RETENTION_BOOTLOADER_INFO_TYPE_MCUBOOT=y
CONFIG_RETENTION_BOOTLOADER_INFO_OUTPUT_SETTINGS=y

CONFIG_MCUBOOT_IMG_MANAGER=y
CONFIG_MCUBOOT_SHELL=y

CONFIG_FPROTECT=y
# CONFIG_FPROTECT_APP=y

CONFIG_GPIO_INIT_PRIORITY=40
CONFIG_NORDIC_QSPI_NOR_INIT_PRIORITY=45

CONFIG_NCS_APPLICATION_BOOT_BANNER_STRING="Ruuvi Air"

CONFIG_FW_INFO=y

CONFIG_RUUVI_AIR_SEN66_VOC_ALG_TUNING_PARAMS_LEARNING_TIME_OFFSET_HOURS=168
CONFIG_RUUVI_AIR_SEN66_VOC_ALG_TUNING_PARAMS_LEARNING_TIME_GAIN_HOURS=168
CONFIG_RUUVI_AIR_SEN66_VOC_ALG_STATE_SAVING_INTERVAL=10
CONFIG_RUUVI_AIR_SEN66_VOC_ALG_STATE_RECOVERY_TIMEOUT=900
